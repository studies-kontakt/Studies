<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Rabattaktionen</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<style>
* {margin:0;padding:0;box-sizing:border-box;}
body {
  font-family:'Roboto',sans-serif;
  background:#f4f6f8;color:#333;line-height:1.5;
  padding:20px;
}

.container {
  max-width:900px;
  margin:40px auto;
  background:white;
  padding:30px;
  border-radius:20px;
  box-shadow:0 10px 30px rgba(0,0,0,0.08);
}

h1 {
  color:#0077cc;
  margin-bottom:10px;
  font-size:32px;
}

.subtitle {
  color:#666;
  margin-bottom:30px;
  font-size:14px;
}

.form-section {
  background:#f7f9fc;
  padding:25px;
  border-radius:12px;
  margin-bottom:30px;
}

.form-section h2 {
  color:#0077cc;
  margin-bottom:20px;
  font-size:20px;
}

label {
  display:block;
  font-weight:600;
  margin-bottom:8px;
  color:#333;
}

input[type=text],
textarea,
select {
  width:100%;
  padding:12px 14px;
  border:1px solid #ddd;
  border-radius:10px;
  font-size:16px;
  margin-bottom:15px;
  background:white;
  font-family:'Roboto',sans-serif;
}

textarea {
  min-height:100px;
  resize:vertical;
}

.color-grid {
  display:grid;
  grid-template-columns:repeat(auto-fit, minmax(80px, 1fr));
  gap:10px;
  margin-bottom:15px;
}

.color-option {
  display:flex;
  flex-direction:column;
  align-items:center;
  cursor:pointer;
  padding:10px;
  border-radius:8px;
  border:2px solid transparent;
  transition:0.2s;
}

.color-option:hover {
  border-color:#0077cc;
}

.color-option input[type=radio] {
  display:none;
}

.color-option input[type=radio]:checked + .color-box {
  border:3px solid #0077cc;
  transform:scale(1.1);
}

.color-box {
  width:50px;
  height:50px;
  border-radius:8px;
  margin-bottom:5px;
  transition:0.2s;
  border:2px solid #ddd;
}

.color-label {
  font-size:12px;
  color:#666;
}

.seiten-auswahl {
  display:grid;
  grid-template-columns:repeat(2, 1fr);
  gap:10px;
  margin-bottom:15px;
}

.checkbox-label {
  display:flex;
  align-items:center;
  padding:12px;
  background:white;
  border-radius:8px;
  border:2px solid #ddd;
  cursor:pointer;
  transition:0.2s;
}

.checkbox-label:hover {
  border-color:#0077cc;
  background:#e0f0ff;
}

.checkbox-label input[type=checkbox] {
  margin-right:10px;
  width:20px;
  height:20px;
  cursor:pointer;
}

.checkbox-label input[type=checkbox]:checked {
  accent-color:#0077cc;
}

.btn {
  padding:14px 25px;
  font-size:18px;
  font-weight:600;
  border:none;
  border-radius:12px;
  cursor:pointer;
  transition:0.3s;
}

.btn-primary {
  background:linear-gradient(90deg,#0077cc,#00aaff);
  color:white;
  width:100%;
}

.btn-primary:hover {
  background:linear-gradient(90deg,#005fa3,#0099dd);
}

.btn-danger {
  background:#ff4444;
  color:white;
  padding:8px 16px;
  font-size:14px;
}

.btn-danger:hover {
  background:#cc0000;
}

.btn-back {
  background:#ccc;
  color:#333;
  margin-bottom:20px;
}

.btn-back:hover {
  background:#999;
}

.aktionen-liste {
  margin-top:30px;
}

.aktion-item {
  background:white;
  padding:20px;
  border-radius:12px;
  margin-bottom:15px;
  box-shadow:0 4px 15px rgba(0,0,0,0.06);
  border-left:5px solid;
}

.aktion-header {
  display:flex;
  justify-content:space-between;
  align-items:start;
  margin-bottom:10px;
}

.aktion-titel {
  font-size:18px;
  font-weight:600;
  color:#333;
}

.aktion-text {
  color:#666;
  margin-bottom:10px;
  line-height:1.6;
}

.aktion-meta {
  display:flex;
  flex-wrap:wrap;
  gap:15px;
  font-size:14px;
  color:#888;
  margin-top:10px;
}

.aktion-badge {
  display:inline-block;
  padding:4px 10px;
  border-radius:6px;
  font-size:12px;
  font-weight:600;
  background:#e0f0ff;
  color:#0077cc;
}

.preview-box {
  background:white;
  padding:15px;
  border-radius:8px;
  margin-top:10px;
}

.empty-state {
  text-align:center;
  padding:40px;
  color:#999;
}

.empty-state svg {
  width:80px;
  height:80px;
  margin-bottom:15px;
  opacity:0.3;
}

.loading {
  text-align:center;
  padding:20px;
  color:#0077cc;
}
</style>
</head>
<body>

<script>
  // PASSWORTSCHUTZ
  const korrektesPasswort = "Studies123";
  const eingabe = prompt("üîí Passwort eingeben:");

  if (eingabe !== korrektesPasswort) {
    alert("‚ùå Falsches Passwort!");
    window.location.href = "https://google.de";
  }
</script>

<div class="container">
  <button class="btn btn-back" onclick="window.location.href='Impressum.html'">‚Üê Zur√ºck zum Impressum</button>

  <h1>üéØ Rabattaktionen verwalten</h1>
  <p class="subtitle">Hier k√∂nnen Sie Rabattaktionen erstellen, die auf ausgew√§hlten Seiten angezeigt werden.</p>

 

  <!-- NEUE AKTION ERSTELLEN -->
  <div class="form-section">
    <h2>Neue Aktion erstellen</h2>

    <label>Titel der Aktion:</label>
    <input type="text" id="aktionTitel" placeholder="z.B. üéâ Sommer-Rabatt 15%">

    <label>Beschreibung:</label>
    <textarea id="aktionText" placeholder="Beschreiben Sie die Aktion, z.B. 'Buchen Sie jetzt und sparen Sie 15% auf alle Umz√ºge im Juli!'"></textarea>

    <label>Farbe ausw√§hlen:</label>
    <div class="color-grid">
      <label class="color-option">
        <input type="radio" name="farbe" value="#d1ecf1,#0c5460" checked>
        <div class="color-box" style="background:#d1ecf1"></div>
        <span class="color-label">Blau</span>
      </label>
      <label class="color-option">
        <input type="radio" name="farbe" value="#d4edda,#155724">
        <div class="color-box" style="background:#d4edda"></div>
        <span class="color-label">Gr√ºn</span>
      </label>
      <label class="color-option">
        <input type="radio" name="farbe" value="#fff3cd,#856404">
        <div class="color-box" style="background:#fff3cd"></div>
        <span class="color-label">Gelb</span>
      </label>
      <label class="color-option">
        <input type="radio" name="farbe" value="#f8d7da,#721c24">
        <div class="color-box" style="background:#f8d7da"></div>
        <span class="color-label">Rot</span>
      </label>
      <label class="color-option">
        <input type="radio" name="farbe" value="#e2d6ff,#4a148c">
        <div class="color-box" style="background:#e2d6ff"></div>
        <span class="color-label">Lila</span>
      </label>
    </div>

    <label>Auf welchen Seiten anzeigen?</label>
    <div class="seiten-auswahl">
      <label class="checkbox-label">
        <input type="checkbox" class="seite-checkbox" value="index" checked>
        <span>Startseite</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" class="seite-checkbox" value="umzug" checked>
        <span>Umzug</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" class="seite-checkbox" value="moebel" checked>
        <span>M√∂bel Auf-/Abbau</span>
      </label>
      <label class="checkbox-label">
        <input type="checkbox" class="seite-checkbox" value="transport" checked>
        <span>Transport</span>
      </label>
    </div>

    <button class="btn btn-primary" onclick="speichereAktion()">‚úÖ Aktion hinzuf√ºgen</button>
  </div>

  <!-- AKTIVE AKTIONEN -->
  <div class="aktionen-liste">
    <h2 style="color:#0077cc;margin-bottom:20px;">üìã Aktive Aktionen</h2>
    <div id="aktionenContainer">
      <div class="loading">Lade Aktionen...</div>
    </div>
  </div>
</div>

<script>
// ========================================
// FIREBASE KONFIGURATION
// ========================================
const firebaseConfig = {
  apiKey: "AIzaSyBNu_uK3SsALV12NZbDi_YhkKwBfaExCOU",
  authDomain: "studies-a1902.firebaseapp.com",
  databaseURL: "https://studies-a1902-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "studies-a1902",
  storageBucket: "studies-a1902.firebasestorage.app",
  messagingSenderId: "488227703018",
  appId: "1:488227703018:web:81f9ca5ed7e62ecfcb6f93"
};

// Firebase initialisieren
firebase.initializeApp(firebaseConfig);
const database = firebase.database();
const aktionenRef = database.ref('rabattAktionen');

// ========================================
// AKTIONEN LADEN
// ========================================
function ladeAktionen() {
  aktionenRef.on('value', (snapshot) => {
    const container = document.getElementById('aktionenContainer');
    const aktionen = [];
    
    snapshot.forEach((child) => {
      aktionen.push({
        id: child.key,
        ...child.val()
      });
    });
    
    if (aktionen.length === 0) {
      container.innerHTML = `
        <div class="empty-state">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path>
          </svg>
          <p>Keine aktiven Aktionen vorhanden</p>
        </div>
      `;
      return;
    }
    
    const seitenNamen = {
      index: 'Startseite',
      umzug: 'Umzug',
      moebel: 'M√∂bel',
      transport: 'Transport'
    };
    
    container.innerHTML = aktionen.map(aktion => {
      const [bg, textColor] = aktion.farbe.split(',');
      const seitenText = aktion.seiten.map(s => seitenNamen[s]).join(', ');
      
      return `
        <div class="aktion-item" style="border-left-color:${textColor}">
          <div class="aktion-header">
            <div class="aktion-titel">${aktion.titel}</div>
            <button class="btn btn-danger" onclick="loescheAktion('${aktion.id}')">üóëÔ∏è L√∂schen</button>
          </div>
          <div class="aktion-text">${aktion.text}</div>
          <div class="aktion-meta">
            <span class="aktion-badge">üìÖ ${new Date(aktion.erstellt).toLocaleDateString('de-DE')}</span>
            <span class="aktion-badge">üìç ${seitenText}</span>
          </div>
          <div class="preview-box" style="background:${bg};color:${textColor};padding:15px;border-radius:8px;margin-top:15px;">
            <strong style="display:block;margin-bottom:5px;">${aktion.titel}</strong>
            ${aktion.text}
          </div>
        </div>
      `;
    }).join('');
  });
}

// ========================================
// AKTION SPEICHERN
// ========================================
function speichereAktion() {
  const titel = document.getElementById('aktionTitel').value.trim();
  const text = document.getElementById('aktionText').value.trim();
  const farbe = document.querySelector('input[name="farbe"]:checked').value;
  const seiten = Array.from(document.querySelectorAll('.seite-checkbox:checked')).map(cb => cb.value);
  
  if (!titel || !text) {
    alert('Bitte f√ºllen Sie Titel und Beschreibung aus!');
    return;
  }
  
  if (seiten.length === 0) {
    alert('Bitte w√§hlen Sie mindestens eine Seite aus!');
    return;
  }
  
  aktionenRef.push({
    titel,
    text,
    farbe,
    seiten,
    erstellt: new Date().toISOString()
  })
  .then(() => {
    document.getElementById('aktionTitel').value = '';
    document.getElementById('aktionText').value = '';
    alert('‚úÖ Aktion wurde erfolgreich gespeichert!');
  })
  .catch(error => {
    console.error('Fehler:', error);
    alert('‚ùå Fehler beim Speichern!');
  });
}

// ========================================
// AKTION L√ñSCHEN
// ========================================
function loescheAktion(id) {
  if (!confirm('M√∂chten Sie diese Aktion wirklich l√∂schen?')) return;
  
  aktionenRef.child(id).remove()
    .then(() => {
      console.log('Aktion gel√∂scht');
    })
    .catch(error => {
      console.error('Fehler:', error);
      alert('‚ùå Fehler beim L√∂schen!');
    });
}

// Beim Laden
ladeAktionen();
</script>

</body>

</html>
